<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Class Roster ‚Äî Room 2</title>
    <style>
        :root {
            --bg-page: #FCFBF7;
            --bg-card: #F5F1E6;
            --border-card: #E6E1D1;
            --text-primary: #1A1A1A;
            --text-secondary: #5C5C5C;
            --text-tertiary: #888888;
            --color-tree: #4F6D46;
            --color-sapling: #7D8C55;
            --color-progress-bg: #EBE7DA;
            --font-serif: 'Georgia', 'Times New Roman', serif;
            --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            --space-md: 16px;
            --space-lg: 24px;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        html, body {
            height: 100%;
            background-color: #DDD9CF;
            display: flex; align-items: center; justify-content: center;
        }

        .screen {
            background-color: var(--bg-page);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            width: 390px; height: 844px;
            overflow: hidden;
            display: flex; flex-direction: column;
            position: relative;
            border-radius: 40px;
            border: 1px solid #ccc;
            box-shadow: 0 28px 72px rgba(0,0,0,0.22), 0 4px 16px rgba(0,0,0,0.08);
            flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ Status Bar ‚îÄ‚îÄ */
        .status-bar {
            height: 50px; padding: 14px var(--space-lg) 0;
            display: flex; align-items: center; justify-content: space-between;
            flex-shrink: 0;
        }
        .status-time { font-size: 15px; font-weight: 600; }
        .status-icons { display: flex; align-items: center; gap: 6px; }

        /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
        .header {
            padding: 10px var(--space-lg) 16px;
            background-color: var(--bg-page);
            z-index: 10; flex-shrink: 0;
        }
        .back-nav {
            display: flex; align-items: center; gap: 8px;
            color: var(--color-tree); font-weight: 600; font-size: 14px;
            margin-bottom: 14px; text-decoration: none; cursor: pointer;
        }
        .header-title-group {
            display: flex; justify-content: space-between; align-items: flex-start;
            margin-bottom: 16px;
        }
        .search-filter-container { display: flex; gap: 12px; margin-bottom: 8px; }
        .search-bar-input {
            flex: 1; background: #F0EDE4; border: 1px solid var(--border-card);
            border-radius: 12px; height: 44px; padding: 0 12px 0 40px;
            font-size: 15px; position: relative; display: flex; align-items: center;
        }
        .search-bar-input input {
            background: none; border: none; outline: none;
            font-size: 15px; font-family: var(--font-sans);
            color: var(--text-primary); width: 100%; height: 100%;
        }
        .search-bar-input input::placeholder { color: var(--text-tertiary); }
        .search-icon { position: absolute; left: 12px; color: var(--text-tertiary); }
        .filter-btn {
            width: 44px; height: 44px; background: #F0EDE4;
            border: 1px solid var(--border-card); border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            color: var(--color-tree); cursor: pointer; flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ Scroll container ‚îÄ‚îÄ */
        .scroll-container {
            flex: 1; overflow-y: auto;
            padding: 0 var(--space-lg) 100px;
            display: flex; flex-direction: column; gap: 12px;
        }
        .scroll-container::-webkit-scrollbar { display: none; }

        .section-label {
            font-size: 12px; font-weight: 700; text-transform: uppercase;
            letter-spacing: 0.1em; color: var(--text-tertiary);
            margin-top: 12px; margin-bottom: 4px;
        }

        /* ‚îÄ‚îÄ Student card ‚îÄ‚îÄ */
        .student-card {
            background-color: var(--bg-card); border-radius: 16px;
            padding: 14px var(--space-lg); border: 1px solid var(--border-card);
            display: flex; align-items: center; gap: 14px;
            text-decoration: none; color: inherit;
            transition: opacity 0.15s;
        }
        .student-card:active { opacity: 0.7; }
        .student-card.hidden { display: none; }

        .avatar-sm {
            width: 48px; height: 48px; border-radius: 24px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0;
        }

        .student-info { flex: 1; min-width: 0; }
        .student-name { font-size: 15px; font-weight: 600; margin-bottom: 0; }
        .student-meta { font-size: 13px; color: var(--text-secondary); margin-top: 3px; }
        .student-meta .alert { color: #B85C00; font-weight: 600; }

        .mastery-badge {
            display: flex; flex-direction: column;
            align-items: flex-end; gap: 2px; flex-shrink: 0;
        }
        .badge-value {
            font-family: var(--font-serif); font-size: 18px;
            font-weight: 700; color: var(--color-tree);
        }
        .badge-label {
            font-size: 10px; font-weight: 700;
            text-transform: uppercase; color: var(--text-tertiary);
        }

        /* ‚îÄ‚îÄ FAB ‚îÄ‚îÄ */
        .fab {
            position: absolute; bottom: 100px; right: 24px;
            width: 56px; height: 56px; border-radius: 28px;
            background-color: var(--color-tree); color: white;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 12px rgba(79,109,70,0.3); z-index: 25; cursor: pointer;
        }

        /* ‚îÄ‚îÄ Bottom Nav ‚îÄ‚îÄ */
        .bottom-nav {
            position: absolute; bottom: 0; left: 0; right: 0;
            height: 84px; background: white;
            border-top: 1px solid var(--border-card);
            display: flex; justify-content: space-around; align-items: center;
            padding-bottom: 20px; z-index: 30;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center;
            gap: 4px; color: var(--text-tertiary); cursor: pointer; text-decoration: none;
        }
        .nav-item.active { color: var(--color-tree); }
        .nav-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; }

        /* ‚îÄ‚îÄ Modal / Sheet base ‚îÄ‚îÄ */
        .modal-sheet {
            display: none; position: absolute; inset: 0;
            background: rgba(0,0,0,0.35); z-index: 300;
            align-items: flex-end; justify-content: center;
        }
        .modal-sheet.open { display: flex; }
        .sheet-body {
            background: white; border-radius: 24px 24px 0 0;
            width: 100%; padding: 28px 24px 48px;
            display: flex; flex-direction: column; gap: 16px;
            max-height: 85vh; overflow-y: auto;
            animation: slideUp 0.25s ease;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .sheet-header { display: flex; justify-content: space-between; align-items: center; }
        .sheet-close {
            background: var(--bg-card); border: none; border-radius: 50%;
            width: 32px; height: 32px; font-size: 20px;
            color: var(--text-secondary); cursor: pointer;
            display: flex; align-items: center; justify-content: center;
        }

        /* Filter chips */
        .filter-chip {
            padding: 8px 16px; border-radius: 20px;
            border: 1.5px solid var(--border-card); background: white;
            font-size: 13px; font-weight: 600; color: var(--text-secondary);
            cursor: pointer; transition: all 0.15s; font-family: var(--font-sans);
        }
        .filter-chip.active {
            background: var(--color-tree); border-color: var(--color-tree); color: white;
        }

        .input-field {
            border: 1.5px solid var(--border-card); border-radius: 12px;
            padding: 12px 14px; font-size: 15px; font-family: var(--font-sans);
            background: var(--bg-page); outline: none;
            color: var(--text-primary); width: 100%;
        }
        .input-field:focus { border-color: var(--color-tree); }
        .input-field.error { border-color: #D4834A; animation: shake 0.3s ease; }
        @keyframes shake {
            0%,100% { transform: translateX(0); }
            20% { transform: translateX(-6px); }
            40% { transform: translateX(6px); }
            60% { transform: translateX(-4px); }
            80% { transform: translateX(4px); }
        }

        .btn-primary {
            background: var(--color-tree); color: white; border: none;
            border-radius: 14px; padding: 16px; font-size: 15px; font-weight: 600;
            font-family: var(--font-sans); cursor: pointer; width: 100%;
        }
        .btn-skip-assess {
            background: none; border: none; color: var(--text-tertiary);
            font-size: 13px; cursor: pointer; text-decoration: underline;
            text-underline-offset: 2px; padding: 4px; align-self: center;
            font-family: var(--font-sans);
        }

        /* ‚îÄ‚îÄ Assessment Sheet ‚îÄ‚îÄ */
        .assessment-sheet {
            display: none; position: absolute; inset: 0;
            background: rgba(0,0,0,0.45); z-index: 400;
            align-items: flex-end; justify-content: center;
        }
        .assessment-sheet.open { display: flex; }
        .assessment-body {
            background: white; border-radius: 24px 24px 0 0;
            width: 100%; padding: 28px 24px 48px;
            display: flex; flex-direction: column; gap: 0;
            max-height: 92vh; overflow-y: auto;
            animation: slideUp 0.25s ease; position: relative;
        }

        .step-dots { display: flex; gap: 6px; justify-content: center; margin-bottom: 16px; }
        .step-dot {
            width: 6px; height: 6px; border-radius: 3px;
            background: var(--color-progress-bg); transition: all 0.3s;
        }
        .step-dot.active { width: 18px; background: var(--color-tree); }
        .step-dot.done { background: var(--color-tree); opacity: 0.4; }

        .assess-step { display: none; flex-direction: column; gap: 16px; }
        .assess-step.active { display: flex; }

        /* Subject choice buttons */
        .subject-choice-btn {
            border: 2px solid var(--border-card); border-radius: 16px;
            padding: 18px 20px; background: var(--bg-card);
            display: flex; align-items: center; gap: 14px;
            cursor: pointer; transition: all 0.15s; text-align: left;
            font-family: var(--font-sans);
        }
        .subject-choice-btn.selected { border-color: var(--color-tree); background: #F0F5ED; }
        .subject-icon {
            width: 44px; height: 44px; border-radius: 12px;
            background: var(--color-progress-bg);
            display: flex; align-items: center; justify-content: center; flex-shrink: 0;
        }
        .subject-label { font-size: 15px; font-weight: 700; color: var(--text-primary); }
        .subject-desc { font-size: 12px; color: var(--text-secondary); margin-top: 2px; }

        .btn-start-assess {
            background: var(--color-tree); color: white; border: none;
            border-radius: 14px; padding: 16px; font-size: 15px; font-weight: 600;
            font-family: var(--font-sans); cursor: pointer; width: 100%;
            opacity: 0.4; pointer-events: none; transition: opacity 0.2s;
        }
        .btn-start-assess.enabled { opacity: 1; pointer-events: auto; }

        /* Quiz */
        .progress-bar-wrap {
            height: 6px; background: var(--color-progress-bg);
            border-radius: 3px; overflow: hidden; margin-bottom: 4px;
        }
        .progress-bar-fill { height: 100%; background: var(--color-tree); border-radius: 3px; transition: width 0.4s; }

        .q-type-label {
            font-size: 11px; font-weight: 700; text-transform: uppercase;
            letter-spacing: 0.08em; color: var(--color-tree);
            background: #F0F5ED; border-radius: 6px; padding: 3px 8px;
            display: inline-block; margin-bottom: 6px;
        }
        .q-text {
            font-family: var(--font-serif); font-size: 20px;
            line-height: 1.35; color: var(--text-primary); margin-bottom: 4px;
        }
        .q-subtext { font-size: 13px; color: var(--text-secondary); margin-bottom: 8px; }
        .q-options { display: flex; flex-direction: column; gap: 10px; }
        .q-option {
            border: 2px solid var(--border-card); border-radius: 14px;
            padding: 14px 16px; font-size: 15px; font-weight: 500;
            background: white; cursor: pointer; transition: all 0.15s;
            text-align: left; color: var(--text-primary); font-family: var(--font-sans);
        }
        .q-option:hover { border-color: var(--color-tree); }
        .q-option.selected { border-color: var(--color-tree); background: #F0F5ED; font-weight: 700; }
        .q-option.correct { border-color: #4F6D46; background: #E8F3E2; color: #2E5422; }
        .q-option.wrong { border-color: #D4834A; background: #FDF0E8; color: #8B3A00; }

        .q-input {
            border: 2px solid var(--border-card); border-radius: 14px;
            padding: 14px 16px; font-size: 22px; font-family: var(--font-serif);
            background: var(--bg-page); outline: none;
            color: var(--text-primary); width: 100%; text-align: center;
        }
        .q-input:focus { border-color: var(--color-tree); }
        .q-input.correct { border-color: #4F6D46; background: #E8F3E2; color: #2E5422; }
        .q-input.wrong { border-color: #D4834A; background: #FDF0E8; color: #8B3A00; }

        .tf-row { display: flex; gap: 12px; }
        .tf-btn {
            flex: 1; border: 2px solid var(--border-card); border-radius: 14px;
            padding: 16px; font-size: 15px; font-weight: 700;
            background: white; cursor: pointer; transition: all 0.15s;
            color: var(--text-primary); font-family: var(--font-sans);
        }
        .tf-btn:hover { border-color: var(--color-tree); }
        .tf-btn.selected { border-color: var(--color-tree); background: #F0F5ED; }
        .tf-btn.correct { border-color: #4F6D46; background: #E8F3E2; color: #2E5422; }
        .tf-btn.wrong { border-color: #D4834A; background: #FDF0E8; color: #8B3A00; }

        .btn-next {
            background: var(--color-tree); color: white; border: none;
            border-radius: 14px; padding: 16px; font-size: 15px; font-weight: 600;
            font-family: var(--font-sans); cursor: pointer; width: 100%;
            margin-top: 8px; opacity: 0.4; pointer-events: none; transition: opacity 0.2s;
        }
        .btn-next.enabled { opacity: 1; pointer-events: auto; }
        .btn-back {
            background: none; border: none; color: var(--text-secondary);
            font-size: 13px; font-weight: 600; cursor: pointer;
            display: flex; align-items: center; gap: 4px;
            padding: 4px 0; font-family: var(--font-sans);
        }

        /* Step 2: Result */
        .confetti-wrap {
            position: absolute; inset: 0; pointer-events: none;
            overflow: hidden; border-radius: 24px 24px 0 0;
        }
        .confetti-piece {
            position: absolute; width: 8px; height: 8px;
            border-radius: 2px; opacity: 0;
            animation: confetti-fall 1.2s ease forwards;
        }
        @keyframes confetti-fall {
            0% { opacity: 1; transform: translateY(-10px) rotate(0deg); }
            100% { opacity: 0; transform: translateY(180px) rotate(480deg); }
        }

        .result-circle {
            width: 100px; height: 100px; border-radius: 50%;
            background: linear-gradient(160deg, #E8F0E0, #C8DDB8);
            display: flex; align-items: center; justify-content: center;
            align-self: center; margin: 8px 0;
        }
        .result-pct { font-family: var(--font-serif); font-size: 32px; font-weight: 700; color: var(--color-tree); }
        .result-label { font-size: 13px; color: var(--text-secondary); text-align: center; }

        .pill-row { display: flex; gap: 8px; flex-wrap: wrap; }
        .pill {
            padding: 6px 14px; border-radius: 20px; font-size: 12px; font-weight: 700;
            background: var(--bg-card); border: 1px solid var(--border-card); color: var(--text-secondary);
        }
        .pill.good { background: #E8F3E2; border-color: #A8D4A0; color: #2E5422; }
        .pill.warn { background: #FDF0E8; border-color: #E8B88A; color: #8B3A00; }

        /* Step 3: All done */
        .final-score-row {
            background: var(--bg-card); border: 1px solid var(--border-card);
            border-radius: 14px; padding: 14px 16px;
            display: flex; align-items: center; justify-content: space-between;
        }
        .final-subject-name { font-size: 14px; font-weight: 600; }
        .final-subject-pct { font-family: var(--font-serif); font-size: 22px; font-weight: 700; }

        /* Toast */
        .toast {
            position: absolute; top: 64px; left: 24px; right: 24px;
            background: #1A1A1A; color: white; padding: 13px 16px;
            border-radius: 14px; font-size: 14px; font-weight: 500;
            z-index: 500; display: none; animation: toastIn 0.22s ease;
        }
        @keyframes toastIn { from { opacity: 0; transform: translateY(-6px); } to { opacity: 1; transform: translateY(0); } }

        #empty-state {
            display: none; text-align: center;
            padding: 40px 0; color: var(--text-tertiary); font-size: 14px;
        }

        /* ‚îÄ‚îÄ Settings ‚îÄ‚îÄ */
        .settings-modal-overlay { display:none; position:absolute; inset:0; background:rgba(0,0,0,0.35); z-index:200; border-radius:40px; align-items:flex-end; }
        .settings-modal-overlay.open { display:flex; }
        .appearance-option { display:flex; align-items:center; gap:12px; padding:13px 14px; border-radius:12px; border:1.5px solid var(--border-card); margin-bottom:10px; cursor:pointer; }
        .appearance-option.selected { border-color:var(--color-tree); background:#F0F5ED; }
        .lang-option { display:flex; align-items:center; gap:12px; padding:12px 14px; border-radius:12px; border:1.5px solid var(--border-card); margin-bottom:8px; cursor:pointer; }
        .lang-option.selected { border-color:var(--color-tree); background:#F0F5ED; }
        .modal-title { font-family:var(--font-serif); font-size:20px; margin-bottom:6px; }
        .modal-subtitle { font-size:13px; color:var(--text-tertiary); margin-bottom:20px; }
        .input-label { font-size:12px; font-weight:700; color:var(--text-tertiary); text-transform:uppercase; letter-spacing:0.06em; margin-bottom:6px; display:block; }
        .modal-check { width:24px; height:24px; border-radius:50%; background:var(--color-tree); color:white; font-size:13px; font-weight:700; display:flex; align-items:center; justify-content:center; }
        .modal-cta { width:100%; padding:14px; border:none; border-radius:14px; background:var(--color-tree); font-size:15px; font-weight:600; color:white; cursor:pointer; font-family:inherit; }
        .modal-close-btn { margin-top:10px; width:100%; padding:14px; border:1.5px solid var(--border-card); border-radius:14px; background:none; font-size:15px; font-weight:600; color:var(--text-secondary); cursor:pointer; font-family:inherit; }
        @media (max-width: 430px) {
            html, body { display: block; width: 100%; height: 100dvh; background-color: var(--bg-page); margin: 0; padding: 0; }
            .screen { width: 100%; height: 100dvh; border-radius: 0; border: none; box-shadow: none; }
        }
    </style>
</head>
<body>
<div class="screen">

    <!-- Status Bar -->
    <div class="status-bar">
        <span class="status-time">9:41</span>
        <div class="status-icons">
            <svg width="17" height="12" viewBox="0 0 17 12" fill="var(--text-primary)"><rect x="0" y="7" width="3" height="5" rx="1"/><rect x="4.5" y="4.5" width="3" height="7.5" rx="1"/><rect x="9" y="2" width="3" height="10" rx="1"/><rect x="13.5" y="0" width="3" height="12" rx="1"/></svg>
            <svg width="16" height="12" viewBox="0 0 16 12" fill="none" stroke="var(--text-primary)" stroke-width="1.5"><path d="M1 4.5C3.8 1.7 8 1 8 1s4.2.7 7 3.5" stroke-linecap="round"/><path d="M3.2 6.8C4.8 5.1 8 4.5 8 4.5s3.2.6 4.8 2.3" stroke-linecap="round"/><path d="M5.5 9.1C6.3 8.3 8 8 8 8s1.7.3 2.5 1.1" stroke-linecap="round"/><circle cx="8" cy="11" r="1" fill="var(--text-primary)" stroke="none"/></svg>
            <svg width="25" height="12" viewBox="0 0 25 12" fill="none"><rect x="0.5" y="0.5" width="21" height="11" rx="3.5" stroke="var(--text-primary)" stroke-opacity="0.35"/><rect x="2" y="2" width="16" height="8" rx="2" fill="var(--text-primary)"/><path d="M23 4v4a2 2 0 000-4z" fill="var(--text-primary)" fill-opacity="0.4"/></svg>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <a href="my-classes.html" class="back-nav">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M15 18l-6-6 6-6"/></svg>
            <span>Classes</span>
        </a>
        <div class="header-title-group">
            <div>
                <h1 style="font-family:var(--font-serif);font-size:28px;line-height:1.2;">Room 2</h1>
                <p style="font-size:14px;color:var(--text-secondary);margin-top:2px;">Grade 2 ‚Ä¢ 24 Students</p>
            </div>
        </div>
        <div class="search-filter-container">
            <div class="search-bar-input">
                <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
                </svg>
                <input id="search-input" type="text" placeholder="Search students..." oninput="filterStudents()">
            </div>
            <button class="filter-btn" onclick="openFilters()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/>
                    <line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/>
                    <line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/>
                    <line x1="2" y1="14" x2="6" y2="14"/><line x1="10" y1="8" x2="14" y2="8"/>
                    <line x1="18" y1="16" x2="22" y2="16"/>
                </svg>
            </button>
        </div>
    </header>

    <!-- Filter Sheet -->
    <div id="filter-modal" class="modal-sheet" onclick="closeFilters()">
        <div class="sheet-body" onclick="event.stopPropagation()">
            <div class="sheet-header">
                <h2 style="font-family:var(--font-serif);font-size:22px;">Filter Students</h2>
                <button class="sheet-close" onclick="closeFilters()">√ó</button>
            </div>
            <div>
                <div style="font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--text-secondary);margin-bottom:10px;">Status</div>
                <div style="display:flex;flex-wrap:wrap;gap:8px;">
                    <button class="filter-chip active" data-filter="all" onclick="setFilter('all',this)">All Students</button>
                    <button class="filter-chip" data-filter="thriving" onclick="setFilter('thriving',this)">üå± Thriving</button>
                    <button class="filter-chip" data-filter="on-track" onclick="setFilter('on-track',this)">‚úÖ On Track</button>
                    <button class="filter-chip" data-filter="needs-attention" onclick="setFilter('needs-attention',this)">‚ö†Ô∏è Needs Attention</button>
                </div>
            </div>
            <div>
                <div style="font-size:12px;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:var(--text-secondary);margin-bottom:10px;">Strength</div>
                <div style="display:flex;flex-wrap:wrap;gap:8px;">
                    <button class="filter-chip" data-strength="" onclick="setStrength('',this)">Any</button>
                    <button class="filter-chip" data-strength="Reading" onclick="setStrength('Reading',this)">Reading</button>
                    <button class="filter-chip" data-strength="Math" onclick="setStrength('Math',this)">Math</button>
                </div>
            </div>
            <button class="btn-primary" onclick="applyFilters()">Apply Filters</button>
        </div>
    </div>

    <!-- Add Student Sheet -->
    <div id="add-student-modal" class="modal-sheet" onclick="closeAddStudent()">
        <div class="sheet-body" onclick="event.stopPropagation()">
            <div class="sheet-header">
                <h2 style="font-family:var(--font-serif);font-size:22px;">Add Student</h2>
                <button class="sheet-close" onclick="closeAddStudent()">√ó</button>
            </div>
            <div style="display:flex;flex-direction:column;gap:8px;">
                <label style="font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-secondary);">Full Name</label>
                <input id="new-student-name" class="input-field" type="text" placeholder="e.g. Hana Malik" maxlength="40" autocomplete="off" oninput="this.style.borderColor=''">
            </div>
            <button class="btn-primary" onclick="proceedToAssessment()">Next: Assess Student ‚Üí</button>
            <button class="btn-skip-assess" onclick="skipAssessmentDirect()">Skip ‚Äî add with 0% mastery</button>
        </div>
    </div>

    <!-- Assessment Sheet -->
    <div id="assessment-modal" class="assessment-sheet" onclick="">
        <div class="assessment-body" onclick="event.stopPropagation()">
            <div class="step-dots">
                <div class="step-dot active" id="dot-0"></div>
                <div class="step-dot" id="dot-1"></div>
                <div class="step-dot" id="dot-2"></div>
                <div class="step-dot" id="dot-3"></div>
            </div>

            <!-- Step 0: Subject selection -->
            <div class="assess-step active" id="assess-step-0">
                <div style="display:flex;justify-content:space-between;align-items:center;">
                    <h2 style="font-family:var(--font-serif);font-size:22px;">Assess Student</h2>
                    <button class="sheet-close" onclick="closeAssessment()">√ó</button>
                </div>
                <p id="assess-student-label" style="font-size:14px;color:var(--text-secondary);margin-top:-4px;">Select which subjects to assess.</p>
                <button class="subject-choice-btn" id="choice-reading" onclick="toggleSubject('reading',this)">
                    <div class="subject-icon">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#4F6D46" stroke-width="2">
                            <path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z"/>
                            <path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z"/>
                        </svg>
                    </div>
                    <div><div class="subject-label">Reading</div><div class="subject-desc">Phonics, sight words &amp; comprehension</div></div>
                </button>
                <button class="subject-choice-btn" id="choice-math" onclick="toggleSubject('math',this)">
                    <div class="subject-icon">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#4F6D46" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
                            <rect x="3" y="3" width="8" height="8" rx="1"/><rect x="13" y="13" width="8" height="8" rx="1"/>
                        </svg>
                    </div>
                    <div><div class="subject-label">Math</div><div class="subject-desc">Counting, addition &amp; number sense</div></div>
                </button>
                <button class="btn-start-assess" id="btn-start-assess" onclick="startAssessment()">Start Assessment</button>
                <button class="btn-skip-assess" onclick="skipAssessment()">Skip ‚Äî start at 0% mastery</button>
                <p id="assess-name-preview" style="font-size:13px;color:var(--text-secondary);text-align:center;margin-top:-8px;font-style:italic;"></p>
            </div>

            <!-- Step 1: Quiz -->
            <div class="assess-step" id="assess-step-1">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;">
                    <button class="btn-back" onclick="goBackToSubjectSelect()">‚Üê Back</button>
                    <span id="assess-subject-label" style="font-size:13px;font-weight:700;color:var(--color-tree);">Reading</span>
                    <span id="assess-q-counter" style="font-size:13px;color:var(--text-tertiary);">Q1 of 5</span>
                </div>
                <div class="progress-bar-wrap"><div class="progress-bar-fill" id="assess-progress" style="width:0%;"></div></div>
                <div id="assess-q-area" style="margin-top:8px;display:flex;flex-direction:column;gap:12px;"></div>
                <button class="btn-next" id="btn-next-q" onclick="nextQuestion()">Next ‚Üí</button>
            </div>

            <!-- Step 2: Subject result -->
            <div class="assess-step" id="assess-step-2" style="position:relative;">
                <div class="confetti-wrap" id="confetti-wrap"></div>
                <h2 style="font-family:var(--font-serif);font-size:22px;text-align:center;" id="result-subject-title">Reading Complete</h2>
                <div class="result-circle"><span class="result-pct" id="result-pct-display">80%</span></div>
                <p class="result-label" id="result-summary">Strong on phonics. Keep building on comprehension.</p>
                <div class="pill-row" id="result-pills" style="justify-content:center;"></div>
                <button class="btn-primary" id="btn-next-subject" onclick="nextSubjectOrFinish()">Continue ‚Üí</button>
            </div>

            <!-- Step 3: All done -->
            <div class="assess-step" id="assess-step-3" style="position:relative;">
                <div class="confetti-wrap" id="confetti-wrap-final"></div>
                <h2 style="font-family:var(--font-serif);font-size:22px;text-align:center;">üå± Assessment Complete</h2>
                <p style="font-size:14px;color:var(--text-secondary);text-align:center;">Here's a summary for <span id="final-student-name" style="font-weight:700;color:var(--text-primary);"></span></p>
                <div id="final-scores" style="display:flex;flex-direction:column;gap:10px;"></div>
                <button class="btn-primary" onclick="confirmAddStudent()">Add to Roster</button>
            </div>
        </div>
    </div>

    <!-- Student list -->
    <main class="scroll-container">
        <h2 class="section-label" id="roster-count">Active Students (6)</h2>

        <!-- Aisha Khan ‚Äî 85% thriving, Reading -->
        <a href="student-detail.html" class="student-card" data-name="aisha khan" data-status="thriving" data-strength="Reading">
            <div class="avatar-sm" style="background:linear-gradient(160deg,#E8F0E0 0%,#C8DDB8 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="36" width="5" height="12" rx="2" fill="#7A5230"/>
                    <ellipse cx="26" cy="30" rx="10" ry="9" fill="#3D6B35"/>
                    <ellipse cx="26" cy="23" rx="13" ry="11" fill="#4F8040"/>
                    <ellipse cx="26" cy="17" rx="9" ry="8" fill="#62A050"/>
                </svg>
            </div>
            <div class="student-info">
                <div class="student-name">Aisha Khan</div>
                <div class="student-meta">Ahead in phonics</div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value">85%</span>
                <span class="badge-label">Mastery</span>
            </div>
        </a>

        <!-- Bilal Ahmed ‚Äî 74% on-track, Math -->
        <a href="student-detail.html" class="student-card" data-name="bilal ahmed" data-status="on-track" data-strength="Math">
            <div class="avatar-sm" style="background:linear-gradient(160deg,#EDF4E8 0%,#D4E8C4 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="37" width="5" height="11" rx="2" fill="#7A5230"/>
                    <ellipse cx="26" cy="28" rx="12" ry="11" fill="#4F7840"/>
                    <ellipse cx="26" cy="22" rx="10" ry="9" fill="#5E9050"/>
                </svg>
            </div>
            <div class="student-info">
                <div class="student-name">Bilal Ahmed</div>
                <div class="student-meta">Needs practice on sums</div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value" style="color:#A07A00;">74%</span>
                <span class="badge-label">Mastery</span>
            </div>
        </a>

        <!-- Zara Chaudhry ‚Äî 92% thriving, Reading -->
        <a href="student-detail.html" class="student-card" data-name="zara chaudhry" data-status="thriving" data-strength="Reading">
            <div class="avatar-sm" style="background:linear-gradient(160deg,#E8F0E0 0%,#C8DDB8 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="36" width="5" height="12" rx="2" fill="#7A5230"/>
                    <ellipse cx="26" cy="31" rx="11" ry="8" fill="#3A6030"/>
                    <ellipse cx="18" cy="26" rx="9" ry="8" fill="#4A7840"/>
                    <ellipse cx="34" cy="26" rx="9" ry="8" fill="#4A7840"/>
                    <ellipse cx="26" cy="20" rx="11" ry="9" fill="#5E9850"/>
                </svg>
            </div>
            <div class="student-info">
                <div class="student-name">Zara Chaudhry</div>
                <div class="student-meta">Top of the class</div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value">92%</span>
                <span class="badge-label">Mastery</span>
            </div>
        </a>

        <!-- Dawood Malik ‚Äî 58% needs-attention, Math -->
        <a href="student-detail.html" class="student-card" style="border-left:4px solid #D4834A;" data-name="dawood malik" data-status="needs-attention" data-strength="Math">
            <div class="avatar-sm" style="background:linear-gradient(160deg,#F5EFE6 0%,#E8DDD0 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="25" y="38" width="3" height="9" rx="1.5" fill="#8B6340"/>
                    <path d="M26 37 Q20 30 22 24 Q26 28 26 37Z" fill="#6A8C50"/>
                    <path d="M26 37 Q32 30 30 24 Q26 28 26 37Z" fill="#5A7A42"/>
                    <ellipse cx="26" cy="24" rx="5" ry="4" fill="#7AAA58"/>
                </svg>
            </div>
            <div class="student-info">
                <div class="student-name">Dawood Malik</div>
                <div class="student-meta"><span class="alert">Struggling with counting</span></div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value" style="color:#B85C00;">58%</span>
                <span class="badge-label" style="color:#B85C00;">Mastery</span>
            </div>
        </a>

        <!-- Emaan Siddiqui ‚Äî 81% on-track, Reading -->
        <a href="student-detail.html" class="student-card" data-name="emaan siddiqui" data-status="on-track" data-strength="Reading">
            <div class="avatar-sm" style="background:linear-gradient(160deg,#EDF4E8 0%,#D4E8C4 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="37" width="4" height="11" rx="2" fill="#7A5230"/>
                    <ellipse cx="26" cy="29" rx="11" ry="10" fill="#4A7838"/>
                    <ellipse cx="26" cy="23" rx="8" ry="7" fill="#60965A"/>
                </svg>
            </div>
            <div class="student-info">
                <div class="student-name">Emaan Siddiqui</div>
                <div class="student-meta">Solid reader</div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value">81%</span>
                <span class="badge-label">Mastery</span>
            </div>
        </a>

        <!-- Annus Raza ‚Äî 79% on-track, Math -->
        <a href="student-detail.html" class="student-card" data-name="annus raza" data-status="on-track" data-strength="Math">
            <div class="avatar-sm" style="background:linear-gradient(160deg,#EDF4E8 0%,#D4E8C4 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="37" width="4" height="11" rx="2" fill="#7A5230"/>
                    <line x1="26" y1="37" x2="18" y2="28" stroke="#7A5230" stroke-width="2.5" stroke-linecap="round"/>
                    <line x1="26" y1="33" x2="34" y2="25" stroke="#7A5230" stroke-width="2.5" stroke-linecap="round"/>
                    <ellipse cx="16" cy="25" rx="7" ry="6" fill="#558040"/>
                    <ellipse cx="35" cy="22" rx="7" ry="6" fill="#558040"/>
                    <ellipse cx="26" cy="20" rx="9" ry="8" fill="#68A050"/>
                </svg>
            </div>
            <div class="student-info">
                <div class="student-name">Annus Raza</div>
                <div class="student-meta">Review subtraction</div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value" style="color:#A07A00;">79%</span>
                <span class="badge-label">Mastery</span>
            </div>
        </a>

        <div id="empty-state">No students match your search.</div>
    </main>

    <!-- FAB -->
    <div class="fab" onclick="openAddStudent()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
    </div>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="goToClasses()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                <circle cx="9" cy="7" r="4"/>
                <path d="M23 21v-2a4 4 0 00-3-3.87"/><path d="M16 3.13a4 4 0 010 7.75"/>
            </svg>
            <span class="nav-label">Classes</span>
        </div>
        <a class="nav-item" href="reports.html">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                <polyline points="14 2 14 8 20 8"/>
                <line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            <span class="nav-label">Reports</span>
        </a>
        <div class="nav-item" onclick="showSettings(true)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
            </svg>
            <span class="nav-label">Settings</span>
        </div>
    </nav>

    <!-- ‚îÄ‚îÄ Settings Screen ‚îÄ‚îÄ -->
    <div id="settings-screen" style="display:none; position:absolute; inset:0; background:var(--bg-page); border-radius:40px; z-index:50; flex-direction:column; overflow:hidden;">
        <div style="padding:60px var(--space-lg) 16px; background:var(--bg-page); flex-shrink:0;">
            <div style="display:flex; align-items:center; justify-content:space-between;">
                <h1 style="font-family:var(--font-serif); font-size:28px;">Settings</h1>
                <button onclick="showSettings(false)" style="background:var(--bg-card); border:1px solid var(--border-card); border-radius:50%; width:32px; height:32px; display:flex; align-items:center; justify-content:center; cursor:pointer; color:var(--text-secondary);">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 6L6 18M6 6l12 12"/></svg>
                </button>
            </div>
        </div>
        <div style="flex:1; overflow-y:auto; padding:0 var(--space-lg) 32px; display:flex; flex-direction:column; gap:24px;">
            <!-- Account -->
            <div>
                <div class="section-label">Account</div>
                <div style="background:var(--bg-card); border-radius:16px; border:1px solid var(--border-card); overflow:hidden;">
                    <div onclick="openSettingsModal('modal-edit-profile')" style="display:flex; align-items:center; gap:14px; padding:16px; cursor:pointer;">
                        <div style="width:44px; height:44px; border-radius:22px; background:linear-gradient(160deg,#E8F0E0 0%,#C8DDB8 100%); display:flex; align-items:center; justify-content:center; font-family:var(--font-serif); font-size:18px; font-weight:600; color:var(--color-tree);">A</div>
                        <div style="flex:1;"><div style="font-size:15px; font-weight:600;">Annus Awan</div><div style="font-size:13px; color:var(--text-tertiary);">annus.awan@seedling.edu</div></div>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#4F6D46" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
                    </div>
                    <div style="height:1px; background:var(--border-card); margin:0 16px;"></div>
                    <div onclick="openSettingsModal('modal-password')" style="display:flex; align-items:center; gap:14px; padding:14px 16px; cursor:pointer;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Change Password</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#888" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
                    </div>
                </div>
            </div>
            <!-- Notifications -->
            <div>
                <div class="section-label">Notifications</div>
                <div style="background:var(--bg-card); border-radius:16px; border:1px solid var(--border-card); overflow:hidden;">
                    <div style="display:flex; align-items:center; gap:14px; padding:14px 16px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Push Notifications</span>
                        <div onclick="toggleSwitch(this)" style="width:44px; height:26px; border-radius:13px; background:var(--color-tree); position:relative; cursor:pointer; transition:background 0.2s; flex-shrink:0;" data-on="true">
                            <div style="width:20px; height:20px; border-radius:10px; background:white; position:absolute; top:3px; left:21px; transition:left 0.2s; box-shadow:0 1px 3px rgba(0,0,0,0.2);"></div>
                        </div>
                    </div>
                    <div style="height:1px; background:var(--border-card); margin:0 16px;"></div>
                    <div style="display:flex; align-items:center; gap:14px; padding:14px 16px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Weekly Email Reports</span>
                        <div onclick="toggleSwitch(this)" style="width:44px; height:26px; border-radius:13px; background:var(--color-tree); position:relative; cursor:pointer; transition:background 0.2s; flex-shrink:0;" data-on="true">
                            <div style="width:20px; height:20px; border-radius:10px; background:white; position:absolute; top:3px; left:21px; transition:left 0.2s; box-shadow:0 1px 3px rgba(0,0,0,0.2);"></div>
                        </div>
                    </div>
                    <div style="height:1px; background:var(--border-card); margin:0 16px;"></div>
                    <div style="display:flex; align-items:center; gap:14px; padding:14px 16px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Intervention Alerts</span>
                        <div onclick="toggleSwitch(this)" style="width:44px; height:26px; border-radius:13px; background:var(--color-tree); position:relative; cursor:pointer; transition:background 0.2s; flex-shrink:0;" data-on="true">
                            <div style="width:20px; height:20px; border-radius:10px; background:white; position:absolute; top:3px; left:21px; transition:left 0.2s; box-shadow:0 1px 3px rgba(0,0,0,0.2);"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Preferences -->
            <div>
                <div class="section-label">Preferences</div>
                <div style="background:var(--bg-card); border-radius:16px; border:1px solid var(--border-card); overflow:hidden;">
                    <div onclick="openSettingsModal('modal-appearance')" style="display:flex; align-items:center; gap:14px; padding:14px 16px; cursor:pointer;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Appearance</span>
                        <span id="pref-appearance-val" style="font-size:13px; color:var(--text-tertiary); margin-right:6px;">Light</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#888" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
                    </div>
                    <div style="height:1px; background:var(--border-card); margin:0 16px;"></div>
                    <div onclick="openSettingsModal('modal-language')" style="display:flex; align-items:center; gap:14px; padding:14px 16px; cursor:pointer;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Language</span>
                        <span id="pref-language-val" style="font-size:13px; color:var(--text-tertiary); margin-right:6px;">English</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#888" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
                    </div>
                    <div style="height:1px; background:var(--border-card); margin:0 16px;"></div>
                    <div onclick="openSettingsModal('modal-report-view')" style="display:flex; align-items:center; gap:14px; padding:14px 16px; cursor:pointer;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">Default Report View</span>
                        <span id="pref-report-val" style="font-size:13px; color:var(--text-tertiary); margin-right:6px;">Detailed</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#888" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
                    </div>
                </div>
            </div>
            <!-- About -->
            <div>
                <div class="section-label">About</div>
                <div style="background:var(--bg-card); border-radius:16px; border:1px solid var(--border-card); overflow:hidden;">
                    <div style="display:flex; align-items:center; gap:14px; padding:14px 16px;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="var(--color-tree)" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500;">App Version</span>
                        <span style="font-size:13px; color:var(--text-tertiary);">2.1.4</span>
                    </div>
                    <div style="height:1px; background:var(--border-card); margin:0 16px;"></div>
                    <div onclick="openSettingsModal('modal-logout')" style="display:flex; align-items:center; gap:14px; padding:14px 16px; cursor:pointer;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#C0392B" stroke-width="2"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        <span style="flex:1; font-size:14px; font-weight:500; color:#C0392B;">Log Out</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#C0392B" stroke-width="2.5"><path d="M9 18l6-6-6-6"/></svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings: Change Password -->
    <div class="settings-modal-overlay" id="modal-password">
        <div style="background:white; border-radius:28px 28px 0 0; width:100%; padding:24px 24px 40px; box-sizing:border-box; max-height:88vh; overflow-y:auto; animation:slideUp 0.25s ease;" onclick="event.stopPropagation()">
            <div style="width:40px; height:4px; background:#E0E0E0; border-radius:2px; margin:0 auto 20px;"></div>
            <h2 class="modal-title">Change Password</h2>
            <p class="modal-subtitle">Annus Awan ¬∑ annus.awan@seedling.edu</p>
            <label class="input-label">Current Password</label>
            <input class="input-field" type="password" placeholder="Enter current password" style="margin-bottom:14px;">
            <label class="input-label">New Password</label>
            <input class="input-field" type="password" placeholder="At least 8 characters" style="margin-bottom:14px;">
            <label class="input-label">Confirm New Password</label>
            <input class="input-field" type="password" placeholder="Repeat new password" style="margin-bottom:8px;">
            <button class="modal-cta" onclick="confirmSettingsAction('modal-password','Password updated!')">Update Password</button>
            <button class="modal-close-btn" onclick="closeSettingsModal('modal-password')">Cancel</button>
        </div>
    </div>

    <!-- Settings: Edit Profile -->
    <div class="settings-modal-overlay" id="modal-edit-profile">
        <div style="background:white; border-radius:28px 28px 0 0; width:100%; padding:24px 24px 40px; box-sizing:border-box; max-height:88vh; overflow-y:auto; animation:slideUp 0.25s ease;" onclick="event.stopPropagation()">
            <div style="width:40px; height:4px; background:#E0E0E0; border-radius:2px; margin:0 auto 20px;"></div>
            <h2 class="modal-title">Edit Profile</h2>
            <p class="modal-subtitle">Update your account information</p>
            <label class="input-label">Full Name</label>
            <input class="input-field" type="text" value="Annus Awan" style="margin-bottom:14px;">
            <label class="input-label">School</label>
            <input class="input-field" type="text" value="Seedling Academy" style="margin-bottom:14px;">
            <label class="input-label">Grade Level</label>
            <select class="input-field" style="margin-bottom:14px; appearance:none;">
                <option>Grade 1</option><option selected>Grade 2</option><option>Grade 3</option><option>Grade 4</option><option>Grade 5</option>
            </select>
            <label class="input-label">Role</label>
            <select class="input-field" style="margin-bottom:8px; appearance:none;">
                <option selected>Class Teacher</option><option>Subject Teacher</option><option>School Admin</option>
            </select>
            <button class="modal-cta" onclick="confirmSettingsAction('modal-edit-profile','Profile updated!')">Save Changes</button>
            <button class="modal-close-btn" onclick="closeSettingsModal('modal-edit-profile')">Cancel</button>
        </div>
    </div>

    <!-- Settings: Appearance -->
    <div class="settings-modal-overlay" id="modal-appearance">
        <div style="background:white; border-radius:28px 28px 0 0; width:100%; padding:24px 24px 40px; box-sizing:border-box; animation:slideUp 0.25s ease;" onclick="event.stopPropagation()">
            <div style="width:40px; height:4px; background:#E0E0E0; border-radius:2px; margin:0 auto 20px;"></div>
            <h2 class="modal-title">Appearance</h2>
            <p class="modal-subtitle">Choose your preferred theme</p>
            <div class="appearance-option selected" onclick="selectAppearance(this,'Light')">
                <span style="font-size:20px;">‚òÄÔ∏è</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">Light</div><div style="font-size:12px; color:var(--text-tertiary);">Default warm paper theme</div></div>
                <div class="modal-check">‚úì</div>
            </div>
            <div class="appearance-option" onclick="selectAppearance(this,'Dark')">
                <span style="font-size:20px;">üåô</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">Dark</div><div style="font-size:12px; color:var(--text-tertiary);">Low-light friendly</div></div>
            </div>
            <div class="appearance-option" onclick="selectAppearance(this,'Auto')">
                <span style="font-size:20px;">‚öôÔ∏è</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">Auto</div><div style="font-size:12px; color:var(--text-tertiary);">Follows system setting</div></div>
            </div>
            <button class="modal-close-btn" onclick="closeSettingsModal('modal-appearance')" style="margin-top:8px;">Done</button>
        </div>
    </div>

    <!-- Settings: Language -->
    <div class="settings-modal-overlay" id="modal-language">
        <div style="background:white; border-radius:28px 28px 0 0; width:100%; padding:24px 24px 40px; box-sizing:border-box; animation:slideUp 0.25s ease;" onclick="event.stopPropagation()">
            <div style="width:40px; height:4px; background:#E0E0E0; border-radius:2px; margin:0 auto 20px;"></div>
            <h2 class="modal-title">Language</h2>
            <p class="modal-subtitle">Choose your display language</p>
            <div class="lang-option selected" onclick="selectLanguage(this,'English')">
                <span style="font-size:20px;">üá¨üáß</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">English</div></div>
                <div class="modal-check">‚úì</div>
            </div>
            <div class="lang-option" onclick="selectLanguage(this,'Urdu')">
                <span style="font-size:20px;">üáµüá∞</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">ÿßÿ±ÿØŸà (Urdu)</div></div>
            </div>
            <div class="lang-option" onclick="selectLanguage(this,'Punjabi')">
                <span style="font-size:20px;">üåø</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">ŸæŸÜÿ¨ÿßÿ®€å (Punjabi)</div></div>
            </div>
            <button class="modal-close-btn" onclick="closeSettingsModal('modal-language')" style="margin-top:8px;">Done</button>
        </div>
    </div>

    <!-- Settings: Default Report View -->
    <div class="settings-modal-overlay" id="modal-report-view">
        <div style="background:white; border-radius:28px 28px 0 0; width:100%; padding:24px 24px 40px; box-sizing:border-box; animation:slideUp 0.25s ease;" onclick="event.stopPropagation()">
            <div style="width:40px; height:4px; background:#E0E0E0; border-radius:2px; margin:0 auto 20px;"></div>
            <h2 class="modal-title">Default Report View</h2>
            <p class="modal-subtitle">Choose how reports appear by default</p>
            <div class="appearance-option" onclick="selectReportView(this,'Summary')">
                <span style="font-size:20px;">üìã</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">Summary</div><div style="font-size:12px; color:var(--text-tertiary);">Quick overview of key metrics</div></div>
            </div>
            <div class="appearance-option selected" onclick="selectReportView(this,'Detailed')">
                <span style="font-size:20px;">üìä</span>
                <div style="flex:1;"><div style="font-size:14px; font-weight:600;">Detailed</div><div style="font-size:12px; color:var(--text-tertiary);">Full breakdown with skill data</div></div>
                <div class="modal-check">‚úì</div>
            </div>
            <button class="modal-close-btn" onclick="closeSettingsModal('modal-report-view')" style="margin-top:8px;">Done</button>
        </div>
    </div>

    <!-- Settings: Log Out -->
    <div class="settings-modal-overlay" id="modal-logout">
        <div style="background:white; border-radius:28px 28px 0 0; width:100%; padding:24px 24px 40px; box-sizing:border-box; animation:slideUp 0.25s ease;" onclick="event.stopPropagation()">
            <div style="width:40px; height:4px; background:#E0E0E0; border-radius:2px; margin:0 auto 20px;"></div>
            <h2 class="modal-title">Log Out</h2>
            <p class="modal-subtitle" style="margin-bottom:24px;">Are you sure you want to sign out of your account?</p>
            <button class="modal-cta" style="background:#C0392B;" onclick="handleLogout()">Yes, Log Out</button>
            <button class="modal-close-btn" onclick="closeSettingsModal('modal-logout')">Cancel</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

</div><!-- /.screen -->
<script>
    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Navigation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function goToClasses() { window.location.href = 'my-classes.html'; }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Search ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function filterStudents() {
        const q = document.getElementById('search-input').value.toLowerCase();
        let visible = 0;
        document.querySelectorAll('.student-card').forEach(c => {
            const match = c.dataset.name.toLowerCase().includes(q);
            c.classList.toggle('hidden', !match);
            if (match) visible++;
        });
        document.getElementById('empty-state').style.display = visible === 0 ? 'block' : 'none';
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Filter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    let activeStatus = 'all', activeStrength = '';

    function openFilters() { document.getElementById('filter-modal').classList.add('open'); }
    function closeFilters() { document.getElementById('filter-modal').classList.remove('open'); }

    function setFilter(val, btn) {
        document.querySelectorAll('[data-filter]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        activeStatus = val;
    }

    function setStrength(val, btn) {
        document.querySelectorAll('[data-strength]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        activeStrength = val;
    }

    function applyFilters() {
        let visible = 0;
        document.querySelectorAll('.student-card').forEach(c => {
            const statusOk = activeStatus === 'all' || c.dataset.status === activeStatus;
            const strengthOk = !activeStrength || c.dataset.strength === activeStrength;
            const show = statusOk && strengthOk;
            c.classList.toggle('hidden', !show);
            if (show) visible++;
        });
        document.getElementById('empty-state').style.display = visible === 0 ? 'block' : 'none';
        closeFilters();
        showToast(activeStatus === 'all' && !activeStrength ? 'Showing all students' : 'Filter applied');
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Add Student ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function openAddStudent() {
        document.getElementById('add-student-modal').classList.add('open');
        setTimeout(() => document.getElementById('new-student-name').focus(), 300);
    }
    function closeAddStudent() {
        document.getElementById('add-student-modal').classList.remove('open');
        document.getElementById('new-student-name').value = '';
    }

    function proceedToAssessment() {
        const nameEl = document.getElementById('new-student-name');
        const name = nameEl.value.trim();
        if (!name) {
            nameEl.classList.add('error');
            setTimeout(() => nameEl.classList.remove('error'), 400);
            nameEl.focus(); return;
        }
        currentStudentName = name;
        closeAddStudent();
        setTimeout(() => {
            document.getElementById('assess-student-label').textContent = 'Assessing ' + name + '. Select which subjects to assess.';
            document.getElementById('assess-name-preview').textContent = name;
            document.getElementById('final-student-name').textContent = name;
            resetAssessmentState();
            document.getElementById('assessment-modal').classList.add('open');
            setAssessStep(0);
        }, 200);
    }

    function skipAssessmentDirect() {
        const nameEl = document.getElementById('new-student-name');
        const name = nameEl.value.trim();
        if (!name) {
            nameEl.classList.add('error');
            setTimeout(() => nameEl.classList.remove('error'), 400);
            nameEl.focus(); return;
        }
        closeAddStudent();
        addStudentCard(name, 0, '‚Äî', 'on-track');
        showToast(name + ' added with 0% mastery');
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Assessment State ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    let currentStudentName = '';
    let selectedSubjects = [];       // ['reading','math'] or subset
    let subjectQueue = [];           // subjects still to assess
    let currentSubjectIndex = 0;
    let currentSubject = '';
    let currentQIndex = 0;
    let answered = false;
    let subjectResults = {};         // { reading: 82, math: 70 }

    const questions = {
        reading: [
            { type: 'mcq', label: 'Phonics', text: 'Which word rhymes with "cat"?', options: ['bat','dog','run','sun'], correct: 0 },
            { type: 'tf',  label: 'Phonics', text: '"Ship" starts with the /sh/ sound.', correct: true },
            { type: 'mcq', label: 'Sight Words', text: 'Choose the word that means the opposite of "big".', options: ['large','huge','small','wide'], correct: 2 },
            { type: 'mcq', label: 'Comprehension', text: '"The cat sat on the mat." Where is the cat?', options: ['On a chair','On the mat','In the tree','By the door'], correct: 1 },
            { type: 'fill', label: 'Vocabulary', text: 'Fill in the blank: The dog is very ___ (it loves to play).', placeholder: 'playful / happy / ‚Ä¶', keyword: ['playful','happy','fun','energetic','active'] },
        ],
        math: [
            { type: 'mcq', label: 'Addition', text: '4 + 3 = ?', options: ['5','6','7','8'], correct: 2 },
            { type: 'tf',  label: 'Number Sense', text: '15 is greater than 12.', correct: true },
            { type: 'mcq', label: 'Counting', text: 'What comes after 19?', options: ['18','20','21','29'], correct: 1 },
            { type: 'fill', label: 'Addition', text: 'Complete: 6 + ___ = 10', placeholder: 'type the missing number', keyword: ['4'] },
            { type: 'mcq', label: 'Place Value', text: 'What is the tens digit in 34?', options: ['4','3','34','1'], correct: 1 },
        ]
    };

    function resetAssessmentState() {
        selectedSubjects = [];
        subjectQueue = [];
        currentSubjectIndex = 0;
        currentSubject = '';
        currentQIndex = 0;
        answered = false;
        subjectResults = {};
        document.getElementById('choice-reading').classList.remove('selected');
        document.getElementById('choice-math').classList.remove('selected');
        const btn = document.getElementById('btn-start-assess');
        btn.classList.remove('enabled');
    }

    function toggleSubject(subj, btn) {
        btn.classList.toggle('selected');
        if (btn.classList.contains('selected')) {
            if (!selectedSubjects.includes(subj)) selectedSubjects.push(subj);
        } else {
            selectedSubjects = selectedSubjects.filter(s => s !== subj);
        }
        const startBtn = document.getElementById('btn-start-assess');
        startBtn.classList.toggle('enabled', selectedSubjects.length > 0);
    }

    function startAssessment() {
        subjectQueue = [...selectedSubjects];
        currentSubjectIndex = 0;
        beginNextSubject();
    }

    function skipAssessment() {
        closeAssessment();
        if (currentStudentName) {
            addStudentCard(currentStudentName, 0, '‚Äî', 'on-track');
            showToast(currentStudentName + ' added with 0% mastery');
        }
    }

    function beginNextSubject() {
        currentSubject = subjectQueue[currentSubjectIndex];
        currentQIndex = 0;
        answered = false;
        document.getElementById('assess-subject-label').textContent = capitalize(currentSubject);
        setAssessStep(1);
        renderQuestion();
    }

    function renderQuestion() {
        const qs = questions[currentSubject];
        const q = qs[currentQIndex];
        const total = qs.length;

        document.getElementById('assess-q-counter').textContent = 'Q' + (currentQIndex + 1) + ' of ' + total;
        document.getElementById('assess-progress').style.width = (currentQIndex / total * 100) + '%';

        const area = document.getElementById('assess-q-area');
        area.innerHTML = '';
        answered = false;
        const nextBtn = document.getElementById('btn-next-q');
        nextBtn.classList.remove('enabled');

        const typeEl = document.createElement('div');
        typeEl.innerHTML = '<span class="q-type-label">' + q.label + '</span>';
        area.appendChild(typeEl);

        const textEl = document.createElement('div');
        textEl.className = 'q-text';
        textEl.textContent = q.text;
        area.appendChild(textEl);

        if (q.type === 'mcq') {
            const opts = document.createElement('div');
            opts.className = 'q-options';
            q.options.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = 'q-option';
                btn.textContent = opt;
                btn.onclick = () => answerMCQ(btn, i, q.correct, opts);
                opts.appendChild(btn);
            });
            area.appendChild(opts);

        } else if (q.type === 'tf') {
            const row = document.createElement('div');
            row.className = 'tf-row';
            ['True','False'].forEach(label => {
                const btn = document.createElement('button');
                btn.className = 'tf-btn';
                btn.textContent = label;
                btn.onclick = () => answerTF(btn, label === 'True', q.correct, row);
                row.appendChild(btn);
            });
            area.appendChild(row);

        } else if (q.type === 'fill') {
            const inp = document.createElement('input');
            inp.className = 'q-input';
            inp.placeholder = q.placeholder;
            inp.oninput = () => {
                if (inp.value.trim()) {
                    nextBtn.classList.add('enabled');
                    answered = true;
                    inp._val = inp.value.trim().toLowerCase();
                } else {
                    nextBtn.classList.remove('enabled');
                    answered = false;
                }
            };
            inp.onkeydown = e => { if (e.key === 'Enter' && answered) nextQuestion(); };
            inp._keywords = q.keyword;
            area.appendChild(inp);
            setTimeout(() => inp.focus(), 100);
        }
    }

    function answerMCQ(btn, chosen, correct, container) {
        if (answered) return;
        answered = true;
        container.querySelectorAll('.q-option').forEach((b, i) => {
            b.onclick = null;
            if (i === correct) b.classList.add('correct');
            else if (b === btn && chosen !== correct) b.classList.add('wrong');
        });
        document.getElementById('btn-next-q').classList.add('enabled');
    }

    function answerTF(btn, chosen, correct, container) {
        if (answered) return;
        answered = true;
        container.querySelectorAll('.tf-btn').forEach(b => {
            b.onclick = null;
            const isTrue = b.textContent === 'True';
            if (isTrue === correct) b.classList.add('correct');
            else if (b === btn) b.classList.add('wrong');
        });
        document.getElementById('btn-next-q').classList.add('enabled');
    }

    function nextQuestion() {
        currentQIndex++;
        const qs = questions[currentSubject];
        if (currentQIndex >= qs.length) {
            showSubjectResult();
        } else {
            renderQuestion();
        }
    }

    function goBackToSubjectSelect() {
        setAssessStep(0);
    }

    function showSubjectResult() {
        // Calculate score based on answered questions (simulate realistic score)
        const base = currentSubject === 'reading' ? 78 : 72;
        const pct = base + Math.floor(Math.random() * 18);
        subjectResults[currentSubject] = pct;

        document.getElementById('result-subject-title').textContent = capitalize(currentSubject) + ' Complete';
        document.getElementById('result-pct-display').textContent = pct + '%';
        document.getElementById('assess-progress').style.width = '100%';

        // Summary text
        const summaries = {
            reading: pct >= 85 ? 'Strong phonics and comprehension!' : pct >= 70 ? 'Good base ‚Äî keep practising sight words.' : 'Needs focused phonics support.',
            math: pct >= 85 ? 'Excellent number sense and addition!' : pct >= 70 ? 'Solid foundation, work on place value.' : 'Needs extra counting and addition practice.',
        };
        document.getElementById('result-summary').textContent = summaries[currentSubject];

        // Skill pills
        const pillsEl = document.getElementById('result-pills');
        pillsEl.innerHTML = '';
        const skillNames = currentSubject === 'reading' ? ['Phonics','Sight Words','Comprehension'] : ['Counting','Addition','Place Value'];
        skillNames.forEach(skill => {
            const p = document.createElement('span');
            p.className = 'pill ' + (Math.random() > 0.4 ? 'good' : 'warn');
            p.textContent = skill;
            pillsEl.appendChild(p);
        });

        // Update continue button
        const remaining = subjectQueue.length - currentSubjectIndex - 1;
        document.getElementById('btn-next-subject').textContent = remaining > 0 ? 'Continue to ' + capitalize(subjectQueue[currentSubjectIndex + 1]) + ' ‚Üí' : 'See Full Summary ‚Üí';

        // Confetti if score good
        if (pct >= 70) spawnConfetti('confetti-wrap');

        setAssessStep(2);
    }

    function nextSubjectOrFinish() {
        currentSubjectIndex++;
        if (currentSubjectIndex < subjectQueue.length) {
            beginNextSubject();
        } else {
            showFinalSummary();
        }
    }

    function showFinalSummary() {
        const scoresEl = document.getElementById('final-scores');
        scoresEl.innerHTML = '';
        Object.entries(subjectResults).forEach(([subj, pct]) => {
            const color = pct >= 80 ? '#4F6D46' : pct >= 65 ? '#A07A00' : '#B85C00';
            const row = document.createElement('div');
            row.className = 'final-score-row';
            row.innerHTML = '<span class="final-subject-name">' + capitalize(subj) + '</span><span class="final-subject-score" style="color:' + color + ';">' + pct + '%</span>';
            scoresEl.appendChild(row);
        });
        spawnConfetti('confetti-wrap-final');
        setAssessStep(3);
    }

    function confirmAddStudent() {
        const scores = Object.values(subjectResults);
        const avg = scores.length ? Math.round(scores.reduce((a,b) => a+b,0) / scores.length) : 0;
        const status = avg >= 80 ? 'thriving' : avg >= 65 ? 'on-track' : 'needs-attention';
        const subj = selectedSubjects.includes('reading') ? 'Reading' : 'Math';
        addStudentCard(currentStudentName, avg, subj, status);
        closeAssessment();
        showToast(currentStudentName + ' added to Room 2! üå±');
    }

    function closeAssessment() {
        document.getElementById('assessment-modal').classList.remove('open');
        setTimeout(resetAssessmentState, 300);
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Avatar helper ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function getTreeAvatar(pct) {
        if (pct >= 75) {
            return `<div class="avatar-sm" style="background:linear-gradient(160deg,#E8F0E0 0%,#C8DDB8 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="36" width="5" height="12" rx="2" fill="#7A5230"/>
                    <ellipse cx="26" cy="30" rx="10" ry="9" fill="#3D6B35"/>
                    <ellipse cx="26" cy="23" rx="13" ry="11" fill="#4F8040"/>
                    <ellipse cx="26" cy="17" rx="9" ry="8" fill="#62A050"/>
                </svg></div>`;
        } else if (pct >= 50) {
            return `<div class="avatar-sm" style="background:linear-gradient(160deg,#EDF4E8 0%,#D4E8C4 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="24" y="37" width="5" height="11" rx="2" fill="#7A5230"/>
                    <ellipse cx="26" cy="28" rx="12" ry="11" fill="#4F7840"/>
                    <ellipse cx="26" cy="22" rx="10" ry="9" fill="#5E9050"/>
                </svg></div>`;
        } else {
            return `<div class="avatar-sm" style="background:linear-gradient(160deg,#F5EFE6 0%,#E8DDD0 100%);">
                <svg width="32" height="32" viewBox="0 0 52 52" fill="none">
                    <rect x="25" y="38" width="3" height="9" rx="1.5" fill="#8B6340"/>
                    <path d="M26 37 Q20 30 22 24 Q26 28 26 37Z" fill="#6A8C50"/>
                    <path d="M26 37 Q32 30 30 24 Q26 28 26 37Z" fill="#5A7A42"/>
                    <ellipse cx="26" cy="24" rx="5" ry="4" fill="#7AAA58"/>
                </svg></div>`;
        }
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Add card to DOM ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function addStudentCard(name, pct, strength, status) {
        const list = document.querySelector('.scroll-container');
        const colors = { thriving: '#4F6D46', 'on-track': '#A07A00', 'needs-attention': '#B85C00' };
        const color = colors[status] || '#4F6D46';
        const card = document.createElement('a');
        card.href = 'student-detail.html';
        card.className = 'student-card';
        card.dataset.name = name.toLowerCase();
        card.dataset.status = status;
        card.dataset.strength = strength;
        card.innerHTML = `
            ${getTreeAvatar(pct)}
            <div class="student-info">
                <div class="student-name">${name}</div>
                <div class="student-meta">Just assessed</div>
            </div>
            <div class="mastery-badge">
                <span class="badge-value" style="color:${color};">${pct}%</span>
                <span class="badge-label">Mastery</span>
            </div>`;

        const emptyState = document.getElementById('empty-state');
        list.insertBefore(card, emptyState);

        // Update count
        const countEl = document.getElementById('roster-count');
        const match = countEl.textContent.match(/\d+/);
        if (match) countEl.textContent = 'Active Students (' + (parseInt(match[0]) + 1) + ')';
    }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Utilities ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function setAssessStep(n) {
        document.querySelectorAll('.assess-step').forEach((s, i) => {
            s.classList.toggle('active', i === n);
        });
        document.querySelectorAll('.step-dot').forEach((d, i) => {
            d.classList.remove('active','done');
            if (i === n) d.classList.add('active');
            else if (i < n) d.classList.add('done');
        });
    }

    function spawnConfetti(containerId) {
        const wrap = document.getElementById(containerId);
        if (!wrap) return;
        wrap.innerHTML = '';
        const colors = ['#4F6D46','#7DB055','#C4A830','#D4834A','#92C463','#3A5C34'];
        for (let i = 0; i < 18; i++) {
            const c = document.createElement('div');
            c.className = 'confetti-piece';
            c.style.left = (Math.random() * 100) + '%';
            c.style.top = '-10px';
            c.style.background = colors[i % colors.length];
            c.style.animationDelay = (Math.random() * 0.6) + 's';
            c.style.transform = 'rotate(' + Math.floor(Math.random() * 360) + 'deg)';
            wrap.appendChild(c);
        }
    }

    function capitalize(s) { return s.charAt(0).toUpperCase() + s.slice(1); }

    /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Settings ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
    function showSettings(v) {
        const s = document.getElementById('settings-screen');
        s.style.display = v ? 'flex' : 'none';
    }
    function openSettingsModal(id) { document.getElementById(id).classList.add('open'); }
    function closeSettingsModal(id) { document.getElementById(id).classList.remove('open'); }
    function confirmSettingsAction(modalId, msg) { closeSettingsModal(modalId); showToast(msg); }

    function toggleSwitch(el) {
        const on = el.dataset.on === 'true';
        el.dataset.on = String(!on);
        el.style.background = !on ? 'var(--color-tree)' : '#D0D0D0';
        el.querySelector('div').style.left = !on ? '21px' : '3px';
    }

    function selectAppearance(el, val) {
        document.querySelectorAll('#modal-appearance .appearance-option').forEach(o => {
            o.classList.remove('selected');
            const c = o.querySelector('.modal-check'); if (c) c.remove();
        });
        el.classList.add('selected');
        const check = document.createElement('div'); check.className = 'modal-check'; check.textContent = '‚úì';
        el.appendChild(check);
        document.getElementById('pref-appearance-val').textContent = val;
    }

    function selectLanguage(el, val) {
        document.querySelectorAll('#modal-language .lang-option').forEach(o => {
            o.classList.remove('selected');
            const c = o.querySelector('.modal-check'); if (c) c.remove();
        });
        el.classList.add('selected');
        const check = document.createElement('div'); check.className = 'modal-check'; check.textContent = '‚úì';
        el.appendChild(check);
        document.getElementById('pref-language-val').textContent = val;
    }

    function selectReportView(el, val) {
        document.querySelectorAll('#modal-report-view .appearance-option').forEach(o => {
            o.classList.remove('selected');
            const c = o.querySelector('.modal-check'); if (c) c.remove();
        });
        el.classList.add('selected');
        const check = document.createElement('div'); check.className = 'modal-check'; check.textContent = '‚úì';
        el.appendChild(check);
        document.getElementById('pref-report-val').textContent = val;
    }

    function handleLogout() {
        closeSettingsModal('modal-logout');
        showSettings(false);
        showToast('Signing out‚Ä¶');
        setTimeout(() => window.location.href = 'index.html', 1200);
    }

    function showToast(msg) {
        const t = document.getElementById('toast');
        t.textContent = msg; t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 3000);
    }
</script>
</body>
</html>
